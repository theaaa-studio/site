<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/responsive.css" />
    <link rel="icon" type="image/x-icon" href="assets/imgs/theaaa2.ico" />
    <title>Abid Al Aqib (The AAA) | Game & XR Developer | Portfolio</title>
    <meta name="theme-color" content="#191c1a" />

    <meta
      name="description"
      content="Discover the portfolio of Abid Al Aqib (The AAA), a seasoned Game & XR Developer. With 8 years in game development, 5 in XR, and leadership experience at Dreamerz Lab LTD, explore his games, Unity assets, Web3D projects, and more."
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
  </head>
  <body id="top">
    <main>
      <!-- Hero -->
      <section id="home">
        <div class="container">
          <div class="glow" aria-hidden="true">
            <div class="g1"></div>
            <div class="g2"></div>
          </div>
          <div class="container hero-wrap">
            <div>
              <div class="eyebrow">Hello, I am</div>
              <h1>The AAA</h1>
              <div class="pill glass">Abid Al Aqib</div>
            </div>
            <div class="hero-card glass">
              <div class="hero-image">
                <div class="">
                  <img src="assets/imgs/theaaa2.ico" alt="Abid Al Aqib" />
                </div>
              </div>
              <h3 class="muted motto" style="margin: 16px 0 8px">
                "Build, Break, Rebuild"
              </h3>
              <p class="motto-sub" style="margin: 0">-The AAA</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Dynamic Content Wrapper -->
      <div id="dynamic-content"></div>
    </main>

    <nav class="bottom-nav" aria-label="Primary">
      <div class="seg glass" role="tablist">
        <a href="#home" role="tab">
          <i class="fas fa-home"></i>
        </a>
        <a href="#tools" role="tab">
          <i class="fas fa-tools"></i>
        </a>
        <a href="#games" role="tab">
          <i class="fas fa-gamepad"></i>
        </a>
        <a href="#about" role="tab">
          <i class="fas fa-user"></i>
        </a>
        <a href="#technology" role="tab">
          <i class="fas fa-microchip"></i>
        </a>
        <a href="#experience" role="tab">
          <i class="fas fa-briefcase"></i>
        </a>
        <a href="#extra" role="tab">
          <i class="fas fa-plus-circle"></i>
        </a>
      </div>
    </nav>

    <script>
      /**
       * Dynamic Content Loader
       * Fetches sections from separate HTML files and injects them into index.html
       */
      const sectionsToLoad = [
        "islamic_project.html",
        "tools.html",
        "games.html",
        "about.html",
        "technology.html",
        "experience.html",
        "extra.html",
        "thanks.html"
      ];

      async function loadSections() {
        const wrapper = document.getElementById("dynamic-content");
        
        for (const file of sectionsToLoad) {
          try {
            const response = await fetch(file);
            if (!response.ok) throw new Error(`Failed to load ${file}`);
            const html = await response.text();
            
            // Parse the HTML and extract the main content (excluding header/nav/footer)
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, "text/html");
            const mainContent = doc.querySelector("main");
            
            if (mainContent) {
              // Append each section from the fetched file's main
              const sections = mainContent.querySelectorAll("section");
              sections.forEach(section => {
                wrapper.appendChild(section.cloneNode(true));
              });
            }
          } catch (error) {
            console.error(error);
          }
        }

        // Re-initialize interactions after content is loaded
        initInteractions();
      }

      function initInteractions() {
        // Accordion interactions
        document.querySelectorAll(".acc").forEach((acc) => {
          // Remove existing listener if any (to avoid duplicates)
          const newAcc = acc.cloneNode(true);
          acc.parentNode.replaceChild(newAcc, acc);
          
          newAcc.addEventListener("click", (e) => {
            const btn = e.target.closest(".acc-btn");
            if (!btn) return;
            const item = btn.parentElement;
            item.classList.toggle("open");
          });
        });

        // Prevention for accordion links
        document.querySelectorAll(".acc-btn a").forEach((a) => {
          a.addEventListener("click", (e) => {
            e.stopPropagation();
          });
        });

        // Initialize Scroll-based Active State tracking
        initScrollTracking();
      }

      function initScrollTracking() {
        const links = Array.from(document.querySelectorAll(".bottom-nav a"));
        const sections = links
          .map((a) => document.querySelector(a.getAttribute("href")))
          .filter(Boolean);

        if (!links.length || !sections.length) return;

        function setActive(id) {
          links.forEach((a) => {
            const on = a.getAttribute("href") === "#" + id;
            a.classList.toggle("active", on);
            a.setAttribute("aria-selected", on ? "true" : "false");
          });
        }

        const io = new IntersectionObserver(
          (entries) => {
            entries.forEach((en) => {
              if (en.isIntersecting) setActive(en.target.id);
            });
          },
          { rootMargin: "-40% 0px -50% 0px", threshold: 0.01 }
        );

        sections.forEach((s) => io.observe(s));
        
        // Initial state
        if (sections[0]) setActive(sections[0].id);
      }

      // Start loading
      window.addEventListener("DOMContentLoaded", loadSections);

      // Handle direct hash navigation on page load
      window.addEventListener("load", () => {
        if (window.location.hash) {
          const target = document.querySelector(window.location.hash);
          if (target) target.scrollIntoView();
        }
      });
    </script>
  </body>
</html>
